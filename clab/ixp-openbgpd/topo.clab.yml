name: obgpd

topology:
  nodes:
    ixp:
      kind: bridge
      labels:
        graph-level: 2
        graph-icon: switch
    srlinux:
      kind: nokia_srlinux
      image: ghcr.io/nokia/srlinux:22.6.4
      startup-config: openbgpd-lab/srlinux.cfg
      labels:
        graph-level: 3
    ceos:
      kind: arista_ceos
      image: ceos:latest
      startup-config: openbgpd-lab/ceos.cfg
      labels:
        graph-level: 3
    openbgpd:
      kind: linux
      image: quay.io/openbgpd/openbgpd:7.7
      binds:
        - openbgpd-lab/openbgpd.conf:/etc/bgpd/bgpd.conf
      exec:
        - "ip address add dev eth1 192.168.0.3/24"
      labels:
        graph-level: 1
        graph-icon: server

    graphite:
      kind: linux
      image: netreplica/graphite:latest
      env:
        CLAB_SSH_CONNECTION: ${SSH_CONNECTION}
      binds:
        - __clabDir__/topology-data.json:/htdocs/default/default.json:ro
      ports:
        - 8080:80
      exec:
        - sh -c 'graphite_motd.sh 8080'
      labels:
        graph-hide: yes

  links:
    - endpoints: ["openbgpd:eth1", "ixp:veth1"]
    - endpoints: ["ceos:eth1", "ixp:veth2"]
    - endpoints: ["srlinux:e1-1", "ixp:veth3"]
