version: '3'
services:
 
  controller:
    image: ghcr.io/open-traffic-generator/keng-controller:1.3.0-2
    command: --accept-eula --http-port 8443  --license-servers=localhost
    network_mode: "host"
    restart: always

  TE1-5551:
    image: ghcr.io/open-traffic-generator/ixia-c-traffic-engine:1.6.0.167
    # command: sleep infinity
    network_mode: "host"
    privileged: true
    volumes:
      - /mnt/huge:/mnt/huge
      - /sys/kernel/mm/hugepages:/sys/kernel/mm/hugepages
      - /sys/bus/pci/drivers:/sys/bus/pci/drivers
      - /sys/devices/system/node:/sys/devices/system/node
      - /dev:/dev
    environment:
      - OPT_LISTEN_PORT=5551
      - ARG_IFACE_LIST=${AgentEth1BusInfo}
      - ARG_CORE_LIST="0 1 2"

  TE1-5552:
    image: ghcr.io/open-traffic-generator/ixia-c-traffic-engine:1.6.0.167
    # command: sleep infinity
    network_mode: "host"
    privileged: true
    volumes:
      - /mnt/huge:/mnt/huge
      - /sys/kernel/mm/hugepages:/sys/kernel/mm/hugepages
      - /sys/bus/pci/drivers:/sys/bus/pci/drivers
      - /sys/devices/system/node:/sys/devices/system/node
      - /dev:/dev
    environment:
      - OPT_LISTEN_PORT=5552
      - ARG_IFACE_LIST=${AgentEth2BusInfo}
      - ARG_CORE_LIST="3 4 5"

  TE1-5553:
    image: ghcr.io/open-traffic-generator/ixia-c-traffic-engine:1.6.0.167
    # command: sleep infinity
    network_mode: "host"
    privileged: true
    volumes:
      - /mnt/huge:/mnt/huge
      - /sys/kernel/mm/hugepages:/sys/kernel/mm/hugepages
      - /sys/bus/pci/drivers:/sys/bus/pci/drivers
      - /sys/devices/system/node:/sys/devices/system/node
      - /dev:/dev
    environment:
      - OPT_LISTEN_PORT=5553
      - ARG_IFACE_LIST=${AgentEth3BusInfo}
      - ARG_CORE_LIST="6 7 8"

  TE1-5554:
    image: ghcr.io/open-traffic-generator/ixia-c-traffic-engine:1.6.0.167
    # command: sleep infinity
    network_mode: "host"
    privileged: true
    volumes:
      - /mnt/huge:/mnt/huge
      - /sys/kernel/mm/hugepages:/sys/kernel/mm/hugepages
      - /sys/bus/pci/drivers:/sys/bus/pci/drivers
      - /sys/devices/system/node:/sys/devices/system/node
      - /dev:/dev
    environment:
      - OPT_LISTEN_PORT=5554
      - ARG_IFACE_LIST=${AgentEth4BusInfo}
      - ARG_CORE_LIST="9 10 11"

  TE1-5555:
    image: ghcr.io/open-traffic-generator/ixia-c-traffic-engine:1.6.0.167
    # command: sleep infinity
    network_mode: "host"
    privileged: true
    volumes:
      - /mnt/huge:/mnt/huge
      - /sys/kernel/mm/hugepages:/sys/kernel/mm/hugepages
      - /sys/bus/pci/drivers:/sys/bus/pci/drivers
      - /sys/devices/system/node:/sys/devices/system/node
      - /dev:/dev
    environment:
      - OPT_LISTEN_PORT=5555
      - ARG_IFACE_LIST=${AgentEth5BusInfo}
      - ARG_CORE_LIST="12 13 14"

  TE1-5556:
    image: ghcr.io/open-traffic-generator/ixia-c-traffic-engine:1.6.0.167
    # command: sleep infinity
    network_mode: "host"
    privileged: true
    volumes:
      - /mnt/huge:/mnt/huge
      - /sys/kernel/mm/hugepages:/sys/kernel/mm/hugepages
      - /sys/bus/pci/drivers:/sys/bus/pci/drivers
      - /sys/devices/system/node:/sys/devices/system/node
      - /dev:/dev
    environment:
      - OPT_LISTEN_PORT=5556
      - ARG_IFACE_LIST=${AgentEth6BusInfo}
      - ARG_CORE_LIST="15 16 17"

  TE1-5557:
    image: ghcr.io/open-traffic-generator/ixia-c-traffic-engine:1.6.0.167
    # command: sleep infinity
    network_mode: "host"
    privileged: true
    volumes:
      - /mnt/huge:/mnt/huge
      - /sys/kernel/mm/hugepages:/sys/kernel/mm/hugepages
      - /sys/bus/pci/drivers:/sys/bus/pci/drivers
      - /sys/devices/system/node:/sys/devices/system/node
      - /dev:/dev
    environment:
      - OPT_LISTEN_PORT=5557
      - ARG_IFACE_LIST=${AgentEth7BusInfo}
      - ARG_CORE_LIST="18 19 20"
